## vlan on layer 3
vlan은 보통 한서브넷당 하나의 vlan이 매핑되는 1:1 관계이다.  
그럼 여러 서브넷을 가지고있는 라우터에선 이를 어떻게 처리할까?  
각 인터페이스마다 하나의 vlan을 할당해줄까?  
그것도 하나의 방법이 될 수는 있지만 인터페이스가 굉장히 부족해질것이다.  

이에 다른 방법으론 ROAS(Router On A Stick)과 3계층 스위치가 있다.  
ROAS먼저 알아보면 한 물리적 인터페이스에서 논리적으로 vlan을 나누는 것이다.  
여기서는 dot1q프로토콜이 사용되어, 라우터가 들어온 패킷의 dot1q tag를 확인해 라우팅해준다.  
물론 개별 인터페이스를 사용하는것보다 대역폭 경쟁이 심해진다.  


다음으론 3계층스위치이다.  
현실에서 가장 많이 쓰이는 방법이다.  
3계층 스위치에서는 SVI(Switch Virtual Interface)를 활성화할 수 있다.  
스위치에서는 각 vlan에 알맞은 인터페이스를 할당해줬으니 트래픽이 들어올때 어떤 vlan에서 왔는지 알 수 있다.  
그러면 스위치는 SVI에서 설정해둔 각 vlan의 subnet을 확인하고 알아서 라우팅해준다.  

3계층 스위치가 라우터의 역할까지 전부하는 것은 아니다.  
3계층 스위치는 2계층 프로토콜인 이더넷만을 사용하기에 외부 인터넷이나 wan으로 나가기위해 외부 라우터가 필요할 수 있다.  
