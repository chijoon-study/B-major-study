## Section 14 정리

## 실습

#### 스위치와 라우터 기초

1. 라우터 구성:
   - **라우터는 서로 다른 서브넷을 연결하는 역할을 한다.** 각 서브넷마다 라우터의 인터페이스에 IP 주소를 설정해야 하며, 이 IP 주소는 해당 서브넷의 호스트들이 사용하는 기본 게이트웨이 역할을 합니다.
   - 라우터의 인터페이스는 기본적으로 비활성화되어 있기 때문에, 설정 후에 `no shutdown` 명령어로 활성화해야 합니다.
   - 예시로, `FastEthernet 0/0`에는 IP 주소 `192.168.0.1/24`, `FastEthernet 0/1`에는 `192.168.1.1/24`로 설정하고 `no shutdown`을 실행했다.

2. 스위치 구성:
   - 2계층 스위치는 라우팅(IP 기반)을 하지 않지만, 관리 목적으로 단일 IP 주소를 가질 수 있다. 이는 가상 인터페이스인 VLAN 1에 할당된다. (VLAN은 나중에 설명)
   - 스위치에서 관리 IP 주소는 `VLAN 1`에 설정되며, 이를 통해 telnet이나 SSH로 원격 관리가 가능.
   - 스위치에는 기본 게이트웨이를 설정해 관리자가 다른 서브넷에서 접근할 수 있도록 해야 하며, 이를 위해 `ip default-gateway` 명령어로 게이트웨이 IP를 설정.

3. 실습 예시:
   - 라우터 `R1`의 `FastEthernet 0/0`에 `192.168.0.1`로 IP 주소를 설정한 뒤, 스위치 `SW1`의 가상 인터페이스 `VLAN 1`에 IP 주소 `192.168.0.10`을 설정하여 두 장치가 같은 서브넷에 연결.
   - 스위치에도 기본 게이트웨이로 라우터의 IP `192.168.0.1`을 설정해, 스위치에서 외부 네트워크와 통신이 가능하도록 구성.

4. 호스트 이름과 설명 설정:
   - 호스트 이름**은 장치 식별을 위해 중요하며, 스위치 `SW1`의 호스트 이름을 `hostname SW1`으로 설정.
   - 인터페이스 설명도 문제 해결 시 도움이 되며, `FastEthernet 0/1`에 `description Link to R1`을 추가해 해당 인터페이스가 라우터와 연결되어 있음을 명확히 함.

#### 설정 마법사

초기화된 라우터/스위치에 접속했을 때, 초기 설정을 도와주는 도구.

실무에서는 거의 안씀. 이미 주로 쓰는 구성을 재사용함.

#### 속도 및 듀플렉스 설정

- Duplex: 시스템 상호간 통신시 송신과 수신이 어떤 형식으로 이루어 지는 지에 대한 mode를 말한다. Simplex, Half Duplex, Full Duplex 등.

1. 인터페이스 속도와 듀플렉스 설정
   - 기본적으로 Cisco 장치들은 속도와 듀플렉스가 자동으로 설정됨.
   - 자동 협상(Autonegotiation)을 통해 양쪽 장치가 전이중(Full-Duplex) 및 최대 속도로 설정됨.
   - 수동 설정이 가장 신뢰성 높음. 특히 라우터, 스위치, 서버와 같은 네트워크 장치에서 속도와 듀플렉스를 수동으로 설정하는 것이 추천됨.
   - 중요한 것은 링크 양쪽을 동일하게 설정해야 한다는 것. 양쪽 모두 자동 또는 수동으로 설정해야 함.
   - 한쪽만 자동, 다른 한쪽은 수동으로 설정하면 성능 저하 또는 연결 해제 등의 문제가 발생할 수 있음.
2. 명령어 소개 및 사용
   - duplex full: 인터페이스의 듀플렉스를 전이중으로 설정.
   - speed 100: 인터페이스 속도를 100Mbps로 설정.
3. 구성 및 상태 확인을 위한 명령어
   - show running-config (show run): 현재 스위치 또는 라우터의 전체 구성을 확인하는 명령어. 자주 사용됨.
   - show ip interface brief (sh ip int brief): 인터페이스의 상태 및 IP 주소 구성을 보여주는 명령어. 네트워크 엔지니어가 자주 사용하는 기본 명령어 중 하나.
   - show run interface vlan 1: VLAN 1 인터페이스의 구성을 확인.
   - show run interface: 특정 인터페이스의 구성만을 확인.
   - show version: Cisco 장치의 IOS 버전, 메모리 크기 등의 정보를 확인하는 명령어.
4. 트래픽 확인 및 오류 검사
   - sh int fast0/1: 해당 인터페이스의 MAC 주소, IP 주소, 트래픽 상태 및 오류 여부를 확인.
   - 트래픽이 정상적으로 흐르고 있는지, 에러가 발생하고 있는지를 확인할 수 있음.

#### CDP와 LLDP

- CDP(Cisco Discovery Protocol)
    - CDP는 Cisco 장비 간에 정보를 공유하기 위해 사용되는 Cisco 전용 2계층 프로토콜. 운영 체제, IP 주소 등의 정보를 인접한 Cisco 장비와 교환하며, 이를 통해 네트워크 관리자들이 토폴로지를 파악하고 문제를 해결할 수 있다.
    - 활용:
        - show cdp neighbors 명령어를 통해 인접 장치의 정보를 볼 수 있어 문제 해결이 용이.
    - 설정:
        - 기본적으로 활성화되어 있으나, no cdp run 명령어로 비활성화할 수 있다.
    보안이 중요한 환경에서는 외부로 향하는 인터페이스에서 비활성화할 수 있다(no cdp enable).
    - 명령어: show cdp, show cdp neighbors, show cdp neighbors detail.

- LLDP(Link Layer Discovery Protocol)
    - 개요:
        - LLDP는 CDP와 유사하지만, Cisco 전용이 아닌 공개 표준 프로토콜. 거의 모든 제조사에서 지원되며, CDP와 비슷한 방식으로 네트워크 정보를 교환.

    - 차이점:
        - LLDP는 표준 프로토콜로 Cisco 이외의 장비에서도 사용.
        - 물리적 인터페이스에서만 작동하고, 가상 인터페이스는 지원하지 않음.
        - CDP는 물리적 포트마다 여러 장치를 감지할 수 있지만, LLDP는 포트당 하나의 장치만 감지.
    - 명령어:
        - lldp run, no lldp transmit, no lldp receive, show lldp, show lldp neighbors, show lldp neighbors detail

#### 1, 2 계층 문제 해결

대충 정리

- 1계층 문제: 케이블 손상, 인터페이스 비활성화, 연결 문제 등
    - 구리/광섬유 케이블 손상 주의: 묶거나 감지 않기
    - 스위치 인터페이스 기본 활성, 라우터는 기본 비활성(no shutdown 명령 필요)
    - 케이블 연결 불량, 장치 전원 꺼짐, 손상된 커넥터 등 주의
    - EMI(전자기 간섭): 최신 케이블로 차폐 가능
    - show ip interface brief로 인터페이스 상태 확인
- 2계층 문제: VLAN 설정 불일치, 속도/듀플렉스 불일치
    - 양쪽 인터페이스 설정 일치 확인: 속도, 듀플렉스 자동/수동 설정
    - 듀플렉스 불일치 시 충돌 발생, CDP 로그로 감지

## 실습

## 리뷰

여기서 알게 된 것

- 스위치의 각 인터페이스(포트)는 기본적으로 하나의 MAC 주소를 가지는 호스트만 연결된다.
    - 다른 스위치나 허브에 연결되는 경우 한 포트에 여러 MAC 주소가 학습(매핑? 테이블에 저장)될 수 있다.
- 라우터의 각 인터페이스는 일반적으로 하나의 서브넷을 가지며, 그 인터페이스에 연결된 네트워크의 기본 게이트웨이 역할을 한다.
    - 라우터 하나에 여러 인터페이스가 있다.
        - 라우터 인터페이스 A: IP 주소 192.168.1.1/24 → 이 인터페이스는 서브넷 192.168.1.0/24에 속함.
        - 라우터 인터페이스 B: IP 주소 10.0.0.1/24 → 이 인터페이스는 서브넷 10.0.0.0/24에 속함.
    - 근데, 인터페이스 B는 다른 라우터에 연결되어있고, A는 로컬 내부의 스위치에 연결되서 로컬에서 처리할 수도 있음.
    - 즉, 라우터의 인터페이스 하나는 다른 서브넷에 연결되며, 정적 라우팅 or 동적 라우팅을 통해서 다른 라우터에 연결되거나, 로컬에서 본인이 처리할 수 있다.
